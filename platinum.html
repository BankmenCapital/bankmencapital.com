<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bankmen Platinum Access</title>
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
  <script src="https://unpkg.com/@solana/wallet-adapter-base@latest/lib/cjs/index.iife.js"></script>
  <script src="https://unpkg.com/@solana/wallet-adapter-wallets@latest/lib/cjs/index.iife.js"></script>
  <script src="https://unpkg.com/@solana/wallet-adapter-react-ui@latest/lib/cjs/index.iife.js"></script>
  <script src="https://unpkg.com/@solana/wallet-adapter-wallets@latest/lib/cjs/index.iife.js"></script>
  <script src="https://unpkg.com/@metaplex-foundation/js@latest/dist/index.iife.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #0a0a0a;
      color: #e5e5e5;
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .fade-in {
      animation: fadeIn 0.7s ease forwards;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(10px);}
      to {opacity: 1; transform: translateY(0);}
    }
  </style>
</head>
<body>
  <div id="app" class="w-full flex justify-center items-center">
    <div id="connect-section" class="text-center">
      <h1 class="text-3xl font-bold mb-6">Bankmen Platinum Access</h1>
      <button id="connectButton" class="px-6 py-3 bg-yellow-500 text-black font-bold rounded-xl hover:bg-yellow-400 transition">
        Connect Wallet
      </button>
      <p id="status" class="mt-4 text-gray-400"></p>
    </div>

    <div id="dashboard" class="hidden fade-in">
      <div class="max-w-3xl mx-auto text-center">
        <h1 class="text-4xl font-bold mb-6 text-yellow-400">ğŸ¦ Bankmen Platinum</h1>
        <p id="walletAddress" class="text-gray-400 mb-4"></p>
        <div class="bg-neutral-900 rounded-2xl p-6 shadow-lg mb-6">
          <h2 class="text-2xl font-semibold mb-2">Your XP</h2>
          <p class="text-4xl font-bold text-yellow-400" id="xp">0</p>
        </div>
        <div class="bg-neutral-900 rounded-2xl p-6 shadow-lg mb-6">
          <h2 class="text-2xl font-semibold mb-4">Your Bankmen NFTs</h2>
          <div id="nftGrid" class="grid grid-cols-2 md:grid-cols-3 gap-4"></div>
        </div>
        <div class="bg-neutral-900 rounded-2xl p-6 shadow-lg">
          <h2 class="text-2xl font-semibold mb-4">Season 1 - Coming Soon</h2>
          <div class="grid grid-cols-4 gap-3">
            <div class="p-4 border border-neutral-700 rounded-lg text-gray-500">ğŸ”’</div>
            <div class="p-4 border border-neutral-700 rounded-lg text-gray-500">ğŸ”’</div>
            <div class="p-4 border border-neutral-700 rounded-lg text-gray-500">ğŸ”’</div>
            <div class="p-4 border border-neutral-700 rounded-lg text-gray-500">ğŸ”’</div>
            <div class="p-4 border border-neutral-700 rounded-lg text-gray-500">ğŸ”’</div>
            <div class="p-4 border border-neutral-700 rounded-lg text-gray-500">ğŸ”’</div>
            <div class="p-4 border border-neutral-700 rounded-lg text-gray-500">ğŸ”’</div>
            <div class="p-4 border border-neutral-700 rounded-lg text-gray-500">ğŸ”’</div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  const COLLECTION_ADDRESS = "GPtMdqNwNFnZGojyxEseXviJUZiqHyHDzWySjSHFup7J";
  const UPDATE_AUTHORITY = "4A644enxADhwaMGsXL4zngnfT2kXRQMjubtQFFrGQb7T";
  const network = "https://api.mainnet-beta.solana.com";

  const connectButton = document.getElementById("connectButton");
  const dashboard = document.getElementById("dashboard");
  const connectSection = document.getElementById("connect-section");
  const status = document.getElementById("status");
  const nftGrid = document.getElementById("nftGrid");
  const walletAddressEl = document.getElementById("walletAddress");

  let wallet, provider;

  async function connectWallet() {
    try {
      provider = window.solana;
      if (!provider || !provider.isPhantom) {
        alert("Please install Phantom Wallet to connect.");
        return;
      }
      const resp = await provider.connect();
      wallet = resp.publicKey.toString();
      walletAddressEl.textContent = "Wallet: " + wallet;
      status.textContent = "Checking NFT ownership...";
      await verifyOwnership(wallet);
    } catch (err) {
      console.error(err);
      status.textContent = "Connection failed.";
    }
  }

  async function verifyOwnership(walletAddress) {
    try {
      const metaplex = new metaplex.Metaplex(new solanaWeb3.Connection(network));
      const owner = new solanaWeb3.PublicKey(walletAddress);
      const nfts = await metaplex.nfts().findAllByOwner({ owner });

      const bankmenNfts = nfts.filter(nft =>
        (nft.collection && nft.collection.address && nft.collection.address.toBase58() === COLLECTION_ADDRESS)
        || (nft.updateAuthorityAddress && nft.updateAuthorityAddress.toBase58() === UPDATE_AUTHORITY)
      );

      if (bankmenNfts.length > 0) {
        status.textContent = "";
        connectSection.classList.add("hidden");
        dashboard.classList.remove("hidden");

        for (const nft of bankmenNfts) {
          if (nft.json?.image) {
            const img = document.createElement("img");
            img.src = nft.json.image;
            img.alt = nft.name;
            img.className = "rounded-xl border border-neutral-700 shadow";
            nftGrid.appendChild(img);
          }
        }

        await provider.signMessage(
          new TextEncoder().encode("I verify my wallet as a Bankmen Capital holder.")
        );
      } else {
        status.textContent = "âŒ Not a verified Bankmen holder.";
      }
    } catch (err) {
      console.error("Verification error:", err);
      status.textContent = "Error verifying ownership.";
    }
  }

  connectButton.addEventListener("click", connectWallet);
</script>
</body>
</html>
